<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Tensor diagrams</title>

  <meta property="description" itemprop="description" content="Penrose notation for deep learning."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-10-19"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-10-19"/>
  <meta name="article:author" content="Piotr Migdał"/>
  <meta name="article:author" content="Claudia Zendejas-Morales"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Tensor diagrams"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Penrose notation for deep learning."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Tensor diagrams"/>
  <meta property="twitter:description" content="Penrose notation for deep learning."/>

  <!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=Physics and Feynman’s Diagrams;citation_publication_date=2005;citation_volume=93;citation_doi=10.1511/2005.52.957;citation_issn=0003-0996, 1545-2786;citation_author=David Kaiser"/>
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","bibliography","output"]}},"value":[{"type":"character","attributes":{},"value":["Tensor diagrams"]},{"type":"character","attributes":{},"value":["Penrose notation for deep learning.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Piotr Migdał"]},{"type":"character","attributes":{},"value":["https://p.migdal.pl"]},{"type":"character","attributes":{},"value":["Quantum Flytrap"]},{"type":"character","attributes":{},"value":["https://quantumgame.io"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Claudia Zendejas-Morales"]},{"type":"character","attributes":{},"value":["http://claudiazm.xyz"]},{"type":"character","attributes":{},"value":["Quantum Flytrap"]},{"type":"character","attributes":{},"value":["https://quantumflytrap.com"]}]}]},{"type":"character","attributes":{},"value":["2021-10-19"]},{"type":"character","attributes":{},"value":["references.bib"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_float","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["build/main.html","build/tensorDiagram.css","ghpages.sh","main_files/anchor-4.2.2/anchor.min.js","main_files/bowser-1.9.3/bowser.min.js","main_files/distill-2.2.21/template.v2.js","main_files/header-attrs-2.7/header-attrs.js","main_files/jquery-1.11.3/jquery.min.js","main_files/popper-2.6.0/popper.min.js","main_files/tippy-6.2.7/tippy-bundle.umd.min.js","main_files/tippy-6.2.7/tippy-light-border.css","main_files/tippy-6.2.7/tippy.css","main_files/tippy-6.2.7/tippy.umd.min.js","main_files/webcomponents-2.0.0/webcomponents.js","playground/bibtex.bib","playground/bra_ket_vue.Rmd","playground/distill_braketvue.Rmd","playground/playground.Rmd","playground/vue_2.Rmd","playground/vue.Rmd","references.bib","sec_intro.html","tensorDiagram.css"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="main_files/header-attrs-2.7/header-attrs.js"></script>
  <script src="main_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="main_files/popper-2.6.0/popper.min.js"></script>
  <link href="main_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="main_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="main_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="main_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="main_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="main_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="main_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Tensor diagrams","description":"Penrose notation for deep learning.","authors":[{"author":"Piotr Migdał","authorURL":"https://p.migdal.pl","affiliation":"Quantum Flytrap","affiliationURL":"https://quantumgame.io","orcidID":""},{"author":"Claudia Zendejas-Morales","authorURL":"http://claudiazm.xyz","affiliation":"Quantum Flytrap","affiliationURL":"https://quantumflytrap.com","orcidID":""}],"publishedDate":"2021-10-19T00:00:00.000+00:00","citationText":"Migdał & Zendejas-Morales, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Tensor diagrams</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Penrose notation for deep learning.</p></p>
</div>

<div class="d-byline">
  Piotr Migdał <a href="https://p.migdal.pl" class="uri">https://p.migdal.pl</a> (Quantum Flytrap)<a href="https://quantumgame.io" class="uri">https://quantumgame.io</a>
  
,   Claudia Zendejas-Morales <a href="http://claudiazm.xyz" class="uri">http://claudiazm.xyz</a> (Quantum Flytrap)<a href="https://quantumflytrap.com" class="uri">https://quantumflytrap.com</a>
  
<br/>2021-10-19
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#background">Background</a></li>
<li><a href="#key-parts">Key parts</a>
<ul>
<li><a href="#tensors">Tensors</a></li>
<li><a href="#basic-operations">Basic operations</a></li>
<li><a href="#dot-operator">Dot operator</a></li>
<li><a href="#other-examples">Other examples</a></li>
</ul></li>
<li><a href="#applications">Applications</a>
<ul>
<li><a href="#machine-learning">Machine learning</a></li>
<li><a href="#deep-learning">Deep learning</a></li>
</ul></li>
<li><a href="#you-may-have-seen-tensor-diagrams">You may have seen tensor diagrams</a></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#footnote">Footnote</a></li>
<li><a href="#todo">TODO</a></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">
<script src='https://unpkg.com/tensor-diagrams@0.3.0/dist/esbuild/tensor-diagrams.js'></script>
<p><link rel='stylesheet' href='tensorDiagram.css'></p>
</div>
<p>Multidimenstional arrays are the basic building blocks for any deep neural network, and many other models in statistics and machine learning. However, even for relatively simple operations the notation becomes monstrous:</p>
<p><span class="math display">\[
\sum_{i_1=1}^n \sum_{i_2=1}^n \sum_{i_3=1}^n \sum_{i_4=1}^n
p_{i_1} T_{i_1 i_2} O_{i_2 j_1}  T_{i_2 i_3} O_{i_3 j_2} T_{i_3 i_4} O_{i_4 j_3}
\]</span></p>
<p>If you are aleary faimiliar with the problem, you may guess that it is probability of observing <span class="math inline">\((j_1, j_2, j_3)\)</span> sequence in a Hidden Markov Model. If you are not, it takes time and effort to parse, and comprehend the formula. In fact, I made a typo when writing it for the first time.</p>
<p>This notation has some problems, as:</p>
<ul>
<li>We introduce indices just to sum over them.</li>
<li>We need to manually inspect which indices repeat (and how many times).</li>
<li>There is no overview over the struture.</li>
</ul>
<p>In this expository article we introduce tensor diagram notation in the context of deep learning. That is - we focus on array of real numbers and relevant operations. We present it as a convenient notation for matrix summation, nothing less more more. In this notation, the described equation becomes</p>
<div id="example1" class="equation">

</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("p", {x: 0, y: 0}, [], ["i0"])
  .addTensor("T", {x: 1, y: 0}, ["i0"], ["i1"])
  .addTensor("T", {x: 3, y: 0}, ["i1"], ["i2"])
  .addTensor("T", {x: 5, y: 0}, ["i2"], ["i3"])
  .addTensor("O", {x: 2, y: 1}, [], [], ["i1"], ["j1"], { labelPos: "left"} )
  .addTensor("O", {x: 4, y: 1}, [], [], ["i2"], ["j2"], { labelPos: "left"} )
  .addTensor("O", {x: 6, y: 1}, [], [], ["i3"], ["j3"], { labelPos: "left"} )
  .addTensor("out", {x: 7, y: 0}, ["i3"], [], [], [], [], { showLabel: false, size: 0.1 })
  .addSummation("i1", {x: 2, y: 0})
  .addSummation("i2", {x: 4, y: 0})
  .addSummation("i3", {x: 6, y: 0}, )
  .setSize(500, 200)
  .draw("#example1");

</script>
</div>
<p>In this article we use <strong>tensor</strong> as in <code>torch.Tensor</code> or TensorFlow - i.e. multidimensional arrays of numebrs with some additional structure. This a very specific case of would a mathematican call a tensor. In this context <strong>tensor product</strong> is <strong>outer product</strong>. (A note for mathematical purists and fetishists: here we work in a finite-dimensional Hilbert space over real numbers, in a fixed basis.) Also, in physics tensors have a need to fullfil certain transformation criteria <a href="https://www.feynmanlectures.caltech.edu/">II 02: Differential Calculus of Vector Fields from The Feynman Lectures on Physics</a>:</p>
<blockquote>
<p>it is not generally true that any three numbers form a vector. It is true only if, when we rotate the coordinate system, the components of the vector transform among themselves in the correct way.</p>
</blockquote>
<h2 id="background">Background</h2>
<p>Tensor diagrams where invented by Penrose<span class="citation" data-cites="penrose_applications_1971">(<a href="#ref-penrose_applications_1971" role="doc-biblioref">Penrose 1971</a>)</span>. For the first contact with tensor diagrams I suggest glaring at the beautiful diagrams<span class="citation" data-cites="bradley_matrices_2019">(<a href="#ref-bradley_matrices_2019" role="doc-biblioref">Bradley 2019</a>)</span>. If you have some background in quantum mechanics, go for a short introduciton<span class="citation" data-cites="biamonte_tensor_2017">(<a href="#ref-biamonte_tensor_2017" role="doc-biblioref">Biamonte and Bergholm 2017</a>)</span> or a slightly longer<span class="citation" data-cites="bridgeman_hand-waving_2017">(<a href="#ref-bridgeman_hand-waving_2017" role="doc-biblioref">Bridgeman and Chubb 2017</a>)</span>.</p>
<p>For a complete introduction I suggest book<span class="citation" data-cites="coecke_picturing_2017">(<a href="#ref-coecke_picturing_2017" role="doc-biblioref">Coecke and Kissinger 2017</a>)</span> or lecture notes <span class="citation" data-cites="biamonte_lectures_2020">(<a href="#ref-biamonte_lectures_2020" role="doc-biblioref">Biamonte 2020</a>)</span>.</p>
<p>Tensor diagrams are popular quantum state decomposition for condensed matter physics<span class="citation" data-cites="orus_practical_2014"><a href="#ref-verstraete_matrix_2008" role="doc-biblioref">Verstraete, Murg, and Cirac</a> (<a href="#ref-verstraete_matrix_2008" role="doc-biblioref">2008</a>)</span>.</p>
<h2 id="key-parts">Key parts</h2>
<h3 id="tensors">Tensors</h3>
<p>A scalar <span class="math inline">\(c\)</span>, a vector <span class="math inline">\(v_i\)</span>, a matrix <span class="math inline">\(M_{ij}\)</span> and a (third-order) tensor <span class="math inline">\(T_{ijk}\)</span> are represented by:</p>
<div id="example2" class="equation">

</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("a", {x: 0, y: 0}, [], [])
  .addTensor("v", {x: 2, y: 0}, [], ["i"])
  .addTensor("M", {x: 5, y: 0}, ["i"], ["j"])
  .addTensor("T", {x: 8, y: 0}, ["i"], ["k"], [], ["j"])
  .setSize(580, 140)
  .draw("#example2");


</script>
</div>
<p>Each loose end correspond to an index.</p>
<h3 id="basic-operations">Basic operations</h3>
<h4 id="scalar-product">Scalar product</h4>
<p>A dot product of two vectors - traditionally: <span class="math inline">\(\vec{v} \cdot \vec{u}\)</span> or in quantum mechanics <span class="math inline">\(\langle u | v \rangle\)</span>.</p>
<div id="einsumindl11" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{i}\]</span>
</div>
<div class="eq-elem tensor-eq-a">
<span class="math display">\[a_{i}\]</span>
</div>
<div class="eq-elem tensor-eq-b">
<span class="math display">\[b_{i}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("u", "start", [], ["i"])
  .addTensor("v", "right", ["i"], [])
  .addContraction(0, 1, "i")
  .setSize(100, 120)
  .draw("#einsumindl11");

</script>
</div>
<h4 id="matrix-vector-multiplication">Matrix-vector multiplication</h4>
<p>A vector transformed by a matrix, traditionally <span class="math inline">\(A \vec{u}\)</span> or in quanutm mechanics <span class="math inline">\(A | v \rangle\)</span>.</p>
<div id="einsumindl9" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{j}\]</span>
</div>
<div class="eq-elem tensor-eq-A">
<span class="math display">\[A_{ij}\]</span>
</div>
<div class="eq-elem tensor-eq-b">
<span class="math display">\[v_{j}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("A", {x: 1, y: 0}, ["i"], ["j"])
  .addTensor("v", "right", ["j"], [])
  .addContraction(0, 1, "j")
  .setSize(160, 120)
  .draw("#einsumindl9");

</script>
</div>
<h4 id="matrix-matrix-multiplication">Matrix-matrix multiplication</h4>
<p>Multiply matrix by matrix, traditionally: <span class="math inline">\(A B\)</span>.</p>
<div id="einsumindl10" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{k}\]</span>
</div>
<div class="eq-elem tensor-eq-A">
<span class="math display">\[A_{ik}\]</span>
</div>
<div class="eq-elem tensor-eq-B">
<span class="math display">\[B_{kj}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("A", {x: 1, y: 0}, ["i"], ["j"])
  .addTensor("B", "right", ["j"], ["k"])
  .addContraction(0, 1, "j")
  .setSize(220, 120)
  .draw("#einsumindl10");

</script>
</div>
<h4 id="outer-product">Outer product</h4>
<p>An outer product between two vectors. In it commonly used in quantum mechanics and written as <span class="math inline">\(| u \rangle \langle v |\)</span>. In particular for <span class="math inline">\(| u \rangle = | v \rangle\)</span>, we get a projection operator <span class="math inline">\(| v \rangle \langle v |\)</span>.</p>
<div id="einsumindl14_1" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\]</span>
</div>
<div class="eq-elem tensor-eq-a">
<span class="math display">\[a_{i}\]</span>
</div>
<div class="eq-elem tensor-eq-b">
<span class="math display">\[b_{j}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("u", {x: 1, y: 0}, ["i"], [])
  .addTensor("v", {x: 2, y: 0}, [], ["j"])
  .setSize(220, 120)
  .draw("#einsumindl14_1");

</script>
</div>
<h4 id="tensor-product">Tensor product</h4>
<p>TODO</p>
<h4 id="expected-value">Expected value</h4>
<p><span class="math inline">\(\sum_{ij} v_i M_{ij} v_j\)</span> (or in the context of quantum: <span class="math inline">\(\langle v | M | v \rangle\)</span>)</p>
<div id="example6" class="equation">

</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("v", {x: 0, y: 0}, [], ["i"])
  .addTensor("M", {x: 1, y: 0}, ["i"], ["j"])
  .addTensor("v", {x: 2, y: 0}, ["j"], [])
  .addContraction(0, 1, "i")
  .addContraction(1, 2, "j")
  .setSize(160, 120)
  .draw("#example6");

</script>
</div>
<h4 id="trace">Trace</h4>
<p>TODO</p>
<h4 id="matrix-transpose">Matrix transpose</h4>
<p>TO FIX</p>
<div id="einsumindl5_1" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\]</span>
</div>
<div class="eq-elem tensor-eq-B">
<span class="math display">\[B_{ji}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("B", {x: 1, y: 0}, ["j"], ["i"])
  .setSize(160, 110)
  .draw("#einsumindl5_1");

</script>
</div>
<h4 id="matrix-is-diagonal">Matrix is diagonal</h4>
<div id="example8" class="equation">

</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("dot", {x: 1, y: 0}, ["i"], ["j"], [], ["k"], { shape:"dot", showLabel: false })
  .addTensor("S", {x: 1, y: 1}, [], [], ["k"], [], { labelPos: "left"} )
  .addContraction(0, 1, "k")
  .setSize(160, 150)
  .draw("#example8");

</script>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 id="dot-operator">Dot operator</h3>
<h4 id="dot-operator-1">Dot operator</h4>
<p>Let’s introduce a symbol for a tensor with all 1s.</p>
<p>In the case of no dimensions, it is just 1, and it is not that interesting. For <span class="math inline">\(v = (1, 1, \ldots, 1)\)</span>. <span class="math inline">\(M\)</span> is an identity matrix or <a href="https://en.wikipedia.org/wiki/Kronecker_delta">Kronecker delta</a>. <span class="math inline">\(T\)</span> is a tensor for which <span class="math inline">\(T_{ijk} = 1\)</span> if <span class="math inline">\(i = j = k\)</span>, otherwise there are 0s.</p>
<div id="example7" class="equation">

</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("dot", {x: 0, y: 0}, [], [], [], [], { shape:"dot", showLabel: false })
  .addTensor("dot", {x: 2, y: 0}, [], ["i"], [], [], { shape:"dot", showLabel: false })
  .addTensor("dot", {x: 5, y: 0}, ["i"], ["j"], [], [], { shape:"dot", showLabel: false })
  .addTensor("dot", {x: 8, y: 0}, ["i"], ["k"], [], ["j"], { shape:"dot", showLabel: false })
  .setSize(580, 140)
  .draw("#example7");

</script>
</div>
<h4 id="sum">Sum</h4>
<div id="einsumindl6" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{ij}\]</span>
</div>
<div class="eq-elem tensor-eq-A">
<span class="math display">\[A_{ij}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("dot", {x: 0, y: 0}, [], ["i"], [], [], { shape: "dot", showLabel: false })
  .addTensor("A", {x: 1, y: 0}, ["i"], ["j"], [], [])
  .addTensor("dot", {x: 2, y: 0}, ["j"], [], [], [], { shape: "dot", showLabel: false })
  .addContraction(0, 1, "i")
  .addContraction(1, 2, "j")
  .setSize(160, 110)
  .draw("#einsumindl6");

</script>
</div>
<h4 id="column-sum">Column sum</h4>
<div id="einsumindl7" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{i}\]</span>
</div>
<div class="eq-elem tensor-eq-A">
<span class="math display">\[A_{ij}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("dot", {x: 0, y: 0}, [], ["i"], [], [], { shape: "dot", showLabel: false })
  .addTensor("A", {x: 1, y: 0}, ["i"], ["j"], [], [])
  .addContraction(0, 1, "i")
  .setSize(160, 110)
  .draw("#einsumindl7");

</script>
</div>
<h4 id="row-sum">Row sum</h4>
<div id="einsumindl8" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{j}\]</span>
</div>
<div class="eq-elem tensor-eq-A">
<span class="math display">\[A_{ij}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("A", {x: 1, y: 0}, ["i"], ["j"], [], [])
  .addTensor("dot", {x: 2, y: 0}, ["j"], [], [], [], { shape: "dot", showLabel: false })
  .addContraction(0, 1, "j")
  .setSize(160, 110)
  .draw("#einsumindl8");

</script>
</div>
<h4 id="hadamard-product">Hadamard product</h4>
<div id="einsumindl13" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\]</span>
</div>
<div class="eq-elem tensor-eq-A">
<span class="math display">\[A_{ij}\]</span>
</div>
<div class="eq-elem tensor-eq-B">
<span class="math display">\[B_{ij}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("dot", {x: 1, y: 1}, ["i"], ["k","m"], [], [], { shape:"dot", showLabel: false })
  .addTensor("A", {x: 2, y: 0}, ["k"], ["l"])
  .addTensor("B", {x: 2, y: 2}, ["m"], ["n"])
  .addTensor("dot", {x: 3, y: 1}, ["l","n"], ["j"], [], [], { shape:"dot", showLabel: false })
  .addContraction(0, 1, "k", "left")
  .addContraction(0, 2, "m", "left")
  .addContraction(1, 3, "l", "left")
  .addContraction(2, 3, "n", "left")
  .setSize(270, 220)
  .draw("#einsumindl13");

</script>
</div>
<h4 id="properties">Properties</h4>
<p>TODO:</p>
<ul>
<li>normalized probabilities (and other momemnts)</li>
<li>matrix is stochastic</li>
<li>matrix is double stochastic</li>
<li>events are independent</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 id="other-examples">Other examples</h3>
<h4 id="scalar-product-of-matrices">Scalar product of matrices</h4>
<p>TO FIX</p>
<div id="einsumindl12" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{ij}\]</span>
</div>
<div class="eq-elem tensor-eq-A">
<span class="math display">\[A_{ij}\]</span>
</div>
<div class="eq-elem tensor-eq-B">
<span class="math display">\[B_{ij}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("A", {x: 1, y: 0}, ["i"], ["j"])
  .addTensor("B", "right", ["j"], ["i"])
  .addContraction(0, 1, "i", "down")
  .addContraction(0, 1, "j")
  .setSize(220, 120)
  .draw("#einsumindl12");

</script>
</div>
<h4 id="applying-a-transformation-to-vectors-in-a-higher-order-tensor">Applying a transformation to vectors in a higher-order tensor</h4>
<div id="einsumindl3" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{k}\]</span>
</div>
<div class="eq-elem tensor-eq-T">
<span class="math display">\[T_{ntk}\]</span>
</div>
<div class="eq-elem tensor-eq-W">
<span class="math display">\[W_{kq}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("T", {x: 1, y: 0}, ["n"], ["k"], [], ["t"])
  .addTensor("W", "right", ["k"], ["q"])
  .addContraction(0, 1, "k")
  .setSize(220, 130)
  .draw("#einsumindl3");

</script>
</div>
<h4 id="order-4-tensor-and-project-vectors-in-the-3rd-dimension">Order-4 tensor and project vectors in the 3rd dimension</h4>
<div id="einsumindl4" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{tk}\]</span>
</div>
<div class="eq-elem tensor-eq-T">
<span class="math display">\[T_{ntkm}\]</span>
</div>
<div class="eq-elem tensor-eq-W">
<span class="math display">\[W_{kq}\]</span>
</div>
</div>
<!-- This diagram has the problem that the label of the first tensor is behind the index "up" or "left" -->
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("T", {x: 1, y: 0}, ["n"], ["k"], ["m"], ["t"], { labelPos: "left" })
  .addTensor("W", "right", ["k"], ["q"])
  .addContraction(0, 1, "k")
  .setSize(220, 140)
  .draw("#einsumindl4");

</script>
</div>
<h4 id="batch-matrix-multiplication">Batch matrix multiplication</h4>
<div id="einsumindl15" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{k}\]</span>
</div>
<div class="eq-elem tensor-eq-A">
<span class="math display">\[A_{ijk}\]</span>
</div>
<div class="eq-elem tensor-eq-B">
<span class="math display">\[B_{ikl}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("B", {x: 1, y: 0}, ["l"], ["k"], [], ["i"])
  .addTensor("A", "right", ["k"], ["j"], [], ["i"])
  .addContraction(0, 1, "k")
  .addContraction(0, 1, "i", "down")
  .setSize(220, 150)
  .draw("#einsumindl15");

</script>
</div>
<h4 id="tensor-contraction">Tensor contraction</h4>
<p>TO FIX</p>
<div id="einsumindl16" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{qr}\]</span>
</div>
<div class="eq-elem tensor-eq-A">
<span class="math display">\[A_{pqrs}\]</span>
</div>
<div class="eq-elem tensor-eq-B">
<span class="math display">\[B_{tuqvr}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("A", {x: 1, y: 0}, ["p"], ["q","r"], ["s"], [], { shape:"rectangle" } )
  .addTensor("B", "right", ["u"], ["q","r"], ["v"], ["t"], { shape:"rectangle" } )
  .addContraction(0, 1, "q")
  .addContraction(0, 1, "r")
  .setSize(220, 260)
  .draw("#einsumindl16");

</script>
</div>
<h4 id="bilinear-transformation">Bilinear transformation</h4>
<p>TODO: dotize “i” (on top)</p>
<div id="einsumindl17" class="equation">
<div class="eq-diagram">

</div>
<div class="eq-elem">
<span class="math display">\[\hspace{0.3cm}=\hspace{0.3cm}\sum_{kl}\]</span>
</div>
<div class="eq-elem tensor-eq-A">
<span class="math display">\[A_{ik}\]</span>
</div>
<div class="eq-elem tensor-eq-B">
<span class="math display">\[B_{jkl}\]</span>
</div>
<div class="eq-elem tensor-eq-C">
<span class="math display">\[C_{il}\]</span>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">

TensorDiagram.new()
  .addTensor("A", {x: 1, y: 0}, ["i"], ["k"])
  .addTensor("B", "right", ["k"], ["l"], [], ["j"])
  .addTensor("C", "right", ["l"], ["i"])
  .addContraction(0, 1, "k")
  .addContraction(1, 2, "l")
  .setSize(270, 130)
  .draw("#einsumindl17");

</script>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="applications">Applications</h2>
<h3 id="machine-learning">Machine learning</h3>
<h4 id="linear-regression">Linear regression</h4>
<p>TODO</p>
<h4 id="factorization-and-svd">Factorization and SVD</h4>
<p>TODO</p>
<h4 id="hidden-markov-model">Hidden Markov Model</h4>
<p>Hidden Markov Models<span class="citation" data-cites="rabiner_tutorial_1989">(<a href="#ref-rabiner_tutorial_1989" role="doc-biblioref">Rabiner 1989</a>)</span>.</p>
<p>TODO</p>
<h4 id="restricted-boltzmann-machine">Restricted Boltzmann Machine</h4>
<p>TODO</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h3 id="deep-learning">Deep learning</h3>
<h4 id="tensors-for-data">Tensors for data</h4>
<p>In deep learning data is structured on 3-5 dimensional tensor. The most typical dimensions are: * sample number (size: batch size), * features - also called embeddings, * spatial coordinates (1D, 2D or 3D).</p>
<p>The order of the dimensions depends on the deep learning framework and concrete functions. For discussions on that, see <a href="https://github.com/stared/pytorch-named-dims">PyTorch tensor dimension names</a>.</p>
<p>Let’s focus on a two-dimensional image with RGB color channels for input.</p>
<div id="dl-data" class="equation">

</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">
TensorDiagram.new()
  .addTensor("X", "start", [], ["n", "c", "x", "y"], [], [], { shape: "rectangle"})
  .setSize(160, 300)
  .draw("#dl-data");
</script>
</div>
<h4 id="averages">Averages</h4>
<p>If we want to average over all samples, e.g. for exploration.</p>
<ul>
<li><a href="https://medium.com/@enjalot/machine-learning-for-visualization-927a9dff1cab">Machine Learning for Visualization - Let’s Explore the Cutest Big Dataset</a> by Ian Johnson,</li>
<li><a href="http://formafluens.io/">Forma Fluens</a> by Visual AI Lab @ IBM Research</li>
<li><a href="https://twitter.com/kcimc/status/902229612666658816?lang=en">QuickDraw Visual Averages by Country</a> by Kyle McDonald</li>
</ul>
<p>we can sum the following way:</p>
<div id="dl-avg-image" class="equation">

</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">
TensorDiagram.new()
  .addTensor("X", "start", [], ["n", "c", "x", "y"], [], [], { shape: "rectangle"})
  .addSummation("n")
  .setSize(160, 300)
  .draw("#dl-avg-image");
</script>
</div>
<p>Channel average values will</p>
<div id="dl-avg-per-channel" class="equation">

</div>
<div class="layout-chunk" data-layout="l-body">
<script type="text/javascript">
TensorDiagram.new()
  .addTensor("X", "start", [], ["n", "c", "x", "y"], [], [], { shape: "rectangle"})
  .addSummation("n")
  .addSummation("x")
  .addSummation("y")
  .setSize(160, 300)
  .draw("#dl-avg-per-channel");
</script>
</div>
<p>Mention:</p>
<ul>
<li>batch normalization</li>
<li>Google Draw dataset</li>
</ul>
<p>Note:</p>
<ul>
<li>do we want/need to introduce a symbol for average vs sum?</li>
</ul>
<h4 id="batch-processing">Batch processing</h4>
<p>TODO</p>
<h4 id="convolutions">Convolutions</h4>
<p>TODO</p>
<h4 id="separable-convolution">Separable convolution</h4>
<p>TODO</p>
<h4 id="non-linearity">Non-linearity</h4>
<p>TODO</p>
<p>And maybe Batch normalization</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<h2 id="you-may-have-seen-tensor-diagrams">You may have seen tensor diagrams</h2>
<p>Feynman Diagrams<span class="citation" data-cites="kaiser_physics_2005">(<a href="#ref-kaiser_physics_2005" role="doc-biblioref">Kaiser 2005</a>)</span> (for unbounded operators on infitely-dimensional Hilbert spaces) and quantum computing.</p>
<p>TODO: Do LSTM diagrams qualify?</p>
<h2 id="conclusion">Conclusion</h2>
<p>Tensor diagrams are cool!</p>
<h2 id="footnote">Footnote</h2>
<p>Written in <a href="https://rstudio.github.io/distill">R Markdown Distill</a>.</p>
<p>Other inspirations:</p>
<ul>
<li><a href="https://rockt.github.io/2018/04/30/einsum">Einsum is All you Need - Einstein Summation in Deep Learning - Tim Rocktäschel</a></li>
<li><a href="https://medium.com/inbrowserai/simple-diagrams-of-convoluted-neural-networks-39c097d2925b">Simple diagrams of convoluted neural networks - Piotr Migdał</a></li>
<li><a href="http://tensornetwork.org/diagrams/">Tensor Diagram Notation - tensornetwork.org</a> for graphic style</li>
<li><a href="https://github.com/stared/thinking-in-tensors-writing-in-pytorch">Thinking in tensors, writing in PyTorch (a hands-on deep learning intro)</a>, especially chapter 1 (it is an eternal Work in Progress, though)</li>
<li><a href="https://github.com/Quantum-Game/bra-ket-vue">bra-ket-vue</a> - a visualizer for quantum states and matrices, aware of the tensor structure</li>
<li><a href="https://jsfiddle.net/stared/8huz5gy7/">Tensor diagram notation in D3.js - JSFiddle</a> - initial version of vis</li>
<li><a href="https://news.ycombinator.com/item?id=23911903">HN on Terry Tao on some desirable properties of mathematical notation</a> - including that “Is it just me, or does probability theory in general have fairly terrible notation?”</li>
</ul>
<h2 id="todo">TODO</h2>
<p>Idea:</p>
<ul>
<li>Antisymmetric tensor and cross product.</li>
<li>Tensors in the sense of TensorFlow and torch.tensor (e.g with einsum).</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-biamonte_lectures_2020" class="csl-entry" role="doc-biblioentry">
Biamonte, Jacob. 2020. <span>“Lectures on <span>Quantum</span> <span>Tensor</span> <span>Networks</span>.”</span> <em>arXiv:1912.10049 [Cond-Mat, Physics:math-Ph, Physics:quant-Ph]</em>, January. <a href="http://arxiv.org/abs/1912.10049">http://arxiv.org/abs/1912.10049</a>.
</div>
<div id="ref-biamonte_tensor_2017" class="csl-entry" role="doc-biblioentry">
Biamonte, Jacob, and Ville Bergholm. 2017. <span>“Tensor <span>Networks</span> in a <span>Nutshell</span>.”</span> <em>arXiv:1708.00006 [Cond-Mat, Physics:gr-Qc, Physics:hep-Th, Physics:math-Ph, Physics:quant-Ph]</em>, July. <a href="http://arxiv.org/abs/1708.00006">http://arxiv.org/abs/1708.00006</a>.
</div>
<div id="ref-bradley_matrices_2019" class="csl-entry" role="doc-biblioentry">
Bradley, Tai-Danae. 2019. <span>“Matrices as <span>Tensor</span> <span>Network</span> <span>Diagrams</span>.”</span> <a href="https://www.math3ma.com/blog/matrices-as-tensor-network-diagrams">https://www.math3ma.com/blog/matrices-as-tensor-network-diagrams</a>.
</div>
<div id="ref-bridgeman_hand-waving_2017" class="csl-entry" role="doc-biblioentry">
Bridgeman, Jacob C, and Christopher T Chubb. 2017. <span>“Hand-Waving and Interpretive Dance: An Introductory Course on Tensor Networks.”</span> <em>Journal of Physics A: Mathematical and Theoretical</em> 50 (22): 223001. <a href="https://doi.org/10.1088/1751-8121/aa6dc3">https://doi.org/10.1088/1751-8121/aa6dc3</a>.
</div>
<div id="ref-coecke_picturing_2017" class="csl-entry" role="doc-biblioentry">
Coecke, Bob, and Aleks Kissinger. 2017. <em>Picturing Quantum Processes: A First Course in Quantum Theory and Diagrammatic Reasoning</em>. Cambridge, United Kingdom ; New York, NY, USA: Cambridge University Press.
</div>
<div id="ref-kaiser_physics_2005" class="csl-entry" role="doc-biblioentry">
Kaiser, David. 2005. <span>“Physics and <span>Feynman</span>’s <span>Diagrams</span>.”</span> <em>American Scientist</em> 93 (2): 156. <a href="https://doi.org/10.1511/2005.52.957">https://doi.org/10.1511/2005.52.957</a>.
</div>
<div id="ref-orus_practical_2014" class="csl-entry" role="doc-biblioentry">
Orús, Román. 2014. <span>“A Practical Introduction to Tensor Networks: <span>Matrix</span> Product States and Projected Entangled Pair States.”</span> <em>Annals of Physics</em> 349 (October): 117–58. <a href="https://doi.org/10.1016/j.aop.2014.06.013">https://doi.org/10.1016/j.aop.2014.06.013</a>.
</div>
<div id="ref-penrose_applications_1971" class="csl-entry" role="doc-biblioentry">
Penrose, Roger. 1971. <span>“Applications of Negative Dimensional Tensors.”</span> <em>Combinatorial Mathematics and Its Applications</em>, no. 1: 221–44. <a href="https://www.mscs.dal.ca/~selinger/papers/graphical-bib/public/Penrose-applications-of-negative-dimensional-tensors.pdf">https://www.mscs.dal.ca/~selinger/papers/graphical-bib/public/Penrose-applications-of-negative-dimensional-tensors.pdf</a>.
</div>
<div id="ref-rabiner_tutorial_1989" class="csl-entry" role="doc-biblioentry">
Rabiner, L. R. 1989. <span>“A Tutorial on Hidden <span>Markov</span> Models and Selected Applications in Speech Recognition.”</span> <em>Proceedings of the IEEE</em> 77 (2): 257–86. <a href="https://doi.org/10.1109/5.18626">https://doi.org/10.1109/5.18626</a>.
</div>
<div id="ref-verstraete_matrix_2008" class="csl-entry" role="doc-biblioentry">
Verstraete, F., V. Murg, and J. I. Cirac. 2008. <span>“Matrix Product States, Projected Entangled Pair States, and Variational Renormalization Group Methods for Quantum Spin Systems.”</span> <em>Advances in Physics</em> 57 (2): 143–224. <a href="https://doi.org/10.1080/14789940801912366">https://doi.org/10.1080/14789940801912366</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
